===========================
SpoolDirJsonSourceConnector
===========================

This connector is used to `stream <https://en.wikipedia.org/wiki/JSON_Streaming>` JSON files from a directory while converting the data based on the schema supplied in the configuration.



-------------
Configuration
-------------

+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| error.path                    | :ref:`configuration-string`  | High       |                                                    | com.github.jcustenborder.kafka.connect.spooldir.SpoolDirSourceConnectorConfig$WritableDirectoryValidator@71d2261e | The directory to place files in which have error(s). This directory must exist and be writable by the user running Kafka Connect.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| finished.path                 | :ref:`configuration-string`  | High       |                                                    | com.github.jcustenborder.kafka.connect.spooldir.SpoolDirSourceConnectorConfig$WritableDirectoryValidator@53917c92 | The directory to place files that have been successfully processed. This directory must exist and be writable by the user running Kafka Connect.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| input.file.pattern            | :ref:`configuration-string`  | High       |                                                    |                                                                                                                   | Regular expression to check input file names against. This expression must match the entire filename. The equivalent of Matcher.matches().                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| input.path                    | :ref:`configuration-string`  | High       |                                                    | com.github.jcustenborder.kafka.connect.spooldir.SpoolDirSourceConnectorConfig$WritableDirectoryValidator@1fa796a4 | The directory to read files that will be processed. This directory must exist and be writable by the user running Kafka Connect.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| topic                         | :ref:`configuration-string`  | High       |                                                    |                                                                                                                   | The Kafka topic to write the data to.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| halt.on.error                 | :ref:`configuration-boolean` | High       | true                                               |                                                                                                                   | Should the task halt when it encounters an error or continue to the next file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| key.schema                    | :ref:`configuration-string`  | High       |                                                    |                                                                                                                   | The schema for the key written to Kafka.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| value.schema                  | :ref:`configuration-string`  | High       |                                                    |                                                                                                                   | The schema for the value written to Kafka.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| schema.generation.enabled     | :ref:`configuration-boolean` | Medium     | false                                              |                                                                                                                   | Flag to determine if schemas should be dynamically generated. If set  to true, `key.schema` and `value.schema` can be omitted, but `schema.generation.key.name` and `schema.generation.value.name` must be set.                                                                                                                                                                                                                                                                                                                                                                                      |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| schema.generation.key.fields  | :ref:`configuration-list`    | Medium     | []                                                 |                                                                                                                   | The field(s) to use to build a key schema. This is only used during schema generation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| schema.generation.key.name    | :ref:`configuration-string`  | Medium     | com.github.jcustenborder.kafka.connect.model.Key   |                                                                                                                   | The name of the generated key schema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| schema.generation.value.name  | :ref:`configuration-string`  | Medium     | com.github.jcustenborder.kafka.connect.model.Value |                                                                                                                   | The name of the generated value schema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| timestamp.field               | :ref:`configuration-string`  | Medium     |                                                    |                                                                                                                   | The field in the value schema that will contain the parsed timestamp for the record. This field cannot be marked as optional and must be a [Timestamp](https://kafka.apache.org/0102/javadoc/org/apache/kafka/connect/data/Schema.html)                                                                                                                                                                                                                                                                                                                                                              |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| timestamp.mode                | :ref:`configuration-string`  | Medium     | PROCESS_TIME                                       | ValidEnum{enum=TimestampMode, allowed=[FIELD, FILE_TIME, PROCESS_TIME]}                                           | Determines how the connector will set the timestamp for the [ConnectRecord](https://kafka.apache.org/0102/javadoc/org/apache/kafka/connect/connector/ConnectRecord.html#timestamp()). If set to `Field` then the timestamp will be read from a field in the value. This field cannot be optional and must be a [Timestamp](https://kafka.apache.org/0102/javadoc/org/apache/kafka/connect/data/Schema.html). Specify the field  in `timestamp.field`. If set to `FILE_TIME` then the last modified time of the file will be used. If set to `PROCESS_TIME` the time the record is read will be used. |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| batch.size                    | :ref:`configuration-int`     | Low        | 1000                                               |                                                                                                                   | The number of records that should be returned with each batch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| empty.poll.wait.ms            | :ref:`configuration-long`    | Low        | 1000                                               | [1,...,9223372036854775807]                                                                                       | The amount of time to wait if a poll returns an empty list of records.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| file.minimum.age.ms           | :ref:`configuration-long`    | Low        | 0                                                  | [0,...,9223372036854775807]                                                                                       | The amount of time in milliseconds after the file was last written to before the file can be processed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| parser.timestamp.date.formats | :ref:`configuration-list`    | Low        | [yyyy-MM-dd'T'HH:mm:ss, yyyy-MM-dd' 'HH:mm:ss]     |                                                                                                                   | The date formats that are expected in the file. This is a list of strings that will be used to parse the date fields in order. The most accurate date format should be the first in the list. Take a look at the Java documentation for more info. https://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html                                                                                                                                                                                                                                                                         |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| parser.timestamp.timezone     | :ref:`configuration-string`  | Low        | UTC                                                |                                                                                                                   | The timezone that all of the dates will be parsed with.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| processing.file.extension     | :ref:`configuration-string`  | Low        | .PROCESSING                                        | ValidPattern{pattern=^.*\..+$}                                                                                    | Before a file is processed, it is renamed to indicate that it is currently being processed. This setting is appended to the end of the file.                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+-------------------------------+------------------------------+------------+----------------------------------------------------+-------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

^^^^^^^^^^^^^^^^^^^^^^
Property based example
^^^^^^^^^^^^^^^^^^^^^^


This configuration is used typically along with `standalone mode
<http://docs.confluent.io/current/connect/concepts.html#standalone-workers>`_.

.. code-block:: properties

    name=connector1
    tasks.max=1
    connector.class=com.github.jcustenborder.kafka.connect.spooldir.SpoolDirJsonSourceConnector
    # The following values must be configured.
    error.path=
    finished.path=
    input.file.pattern=
    input.path=
    topic=



^^^^^^^^^^^^^^^^^^
Rest based example
^^^^^^^^^^^^^^^^^^


This configuration is used typically along with `distributed mode
<http://docs.confluent.io/current/connect/concepts.html#distributed-workers>`_.
Write the following json to `connector.json` and use the command below to post the configuration to the distributed connect workers.

.. code-block:: json

    {
        "name": "connector1",
        "config": {
            "connector.class": "com.github.jcustenborder.kafka.connect.spooldir.SpoolDirJsonSourceConnector",
            "error.path":"",
            "finished.path":"",
            "input.file.pattern":"",
            "input.path":"",
            "topic":"",
        }
    }

Use curl to post the configuration to one of the Kafka Connect Workers. Change `http://localhost:8083/` the the endpoint of
one of your Kafka Connect workers.

.. code-block:: bash

    curl -s -X POST -H 'Content-Type: application/json' --data @connector.json http://localhost:8083/connectors



