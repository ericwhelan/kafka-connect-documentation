=====================
InfluxDBSinkConnector
=====================

The InfluxDBSinkConnector is used to write data from a :term:`Kafka topic`_ to an InfluxDB host. When there are more than one record in a batch that have the same measurement, time, and tags, they will be combined to a single point an written to InfluxDB in a batch.



-------------
Configuration
-------------

+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.database          | :ref:`configuration-string`   | High       |               |                                                                                                            | The influxdb database to write to. |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.url               | :ref:`configuration-string`   | High       |               |                                                                                                            | influxdb.url                       |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.password          | :ref:`configuration-password` | High       | [hidden]      |                                                                                                            | influxdb.password                  |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.username          | :ref:`configuration-string`   | High       |               |                                                                                                            | influxdb.username                  |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.consistency.level | :ref:`configuration-string`   | Medium     | ONE           | ValidEnum{enum=ConsistencyLevel, allowed=[ALL, ANY, ONE, QUORUM]}                                          | influxdb.consistency.level         |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.timeunit          | :ref:`configuration-string`   | Medium     | MILLISECONDS  | ValidEnum{enum=TimeUnit, allowed=[NANOSECONDS, MICROSECONDS, MILLISECONDS, SECONDS, MINUTES, HOURS, DAYS]} | influxdb.timeunit                  |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.expected.keys     | :ref:`configuration-int`      | Low        | 100           | [1,...]                                                                                                    | influxdb.expected.keys             |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.expected.values   | :ref:`configuration-int`      | Low        | 1000          | [1,...]                                                                                                    | influxdb.expected.values           |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.gzip.enable       | :ref:`configuration-boolean`  | Low        | true          |                                                                                                            | influxdb.gzip.enable               |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+
| influxdb.log.level         | :ref:`configuration-string`   | Low        | NONE          | ValidEnum{enum=LogLevel, allowed=[NONE, BASIC, HEADERS, FULL]}                                             | influxdb.log.level                 |
+----------------------------+-------------------------------+------------+---------------+------------------------------------------------------------------------------------------------------------+------------------------------------+

^^^^^^^^^^^^^^^^^^^^^^
Property based example
^^^^^^^^^^^^^^^^^^^^^^


This configuration is used typically along with `standalone mode
<http://docs.confluent.io/current/connect/concepts.html#standalone-workers>`_.

.. code-block:: properties

    name=connector1
    tasks.max=1
    connector.class=com.github.jcustenborder.kafka.connect.influxdb.InfluxDBSinkConnector
    # The following values must be configured.
    influxdb.database=
    influxdb.url=



^^^^^^^^^^^^^^^^^^
Rest based example
^^^^^^^^^^^^^^^^^^


This configuration is used typically along with `distributed mode
<http://docs.confluent.io/current/connect/concepts.html#distributed-workers>`_.
Write the following json to `connector.json` and use the command below to post the configuration to the distributed connect workers.

.. code-block:: json

    {
        "name": "connector1",
        "config": {
            "connector.class": "com.github.jcustenborder.kafka.connect.influxdb.InfluxDBSinkConnector",
            "influxdb.database":"",
            "influxdb.url":"",
        }
    }

Use curl to post the configuration to one of the Kafka Connect Workers. Change `http://localhost:8083/` the the endpoint of
one of your Kafka Connect workers.

.. code-block:: bash

    curl -s -X POST -H 'Content-Type: application/json' --data @connector.json http://localhost:8083/connectors



